@model List<CartItem>
@{
    var total = Model?.Sum(c => c.Price * c.Quantity) ?? 0;
    var itemCount = Model?.Sum(c => c.Quantity) ?? 0;
}

<div class="cart-sidebar-header">
    <h5 class="m-0 fw-bold">üõí –ö–æ—à–∏–∫ <span class="badge bg-primary ms-2" id="sidebar-cart-count">@itemCount</span></h5>
    <button type="button" class="btn-close" id="closeCartSidebar" aria-label="–ó–∞–∫—Ä–∏—Ç–∏"></button>
</div>

<div class="cart-sidebar-body">
    @if (Model != null && Model.Any())
    {
        <div class="cart-items-list" id="cart-items-list">
            @foreach (var item in Model)
            {
                <div class="cart-sidebar-item" data-product-id="@item.ProductId">
                    <img src="@item.ImageUrl" alt="@item.Name" class="cart-item-thumb">
                    <div class="cart-item-info">
                        <div class="cart-item-name">@item.Name</div>
                        <div class="cart-item-price">@item.Price.ToString("0.00") ‚Ç¥</div>
                    </div>
                    <div class="cart-item-actions">
                        <div class="qty-controls">
                            <button class="qty-btn" data-action="decrease" data-product-id="@item.ProductId">‚àí</button>
                            <span class="qty-value">@item.Quantity</span>
                            <button class="qty-btn" data-action="increase" data-product-id="@item.ProductId">+</button>
                        </div>
                        <button class="btn-remove-item" data-product-id="@item.ProductId" title="–í–∏–¥–∞–ª–∏—Ç–∏">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        </button>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="cart-empty-state">
            <div class="cart-empty-icon">üõí</div>
            <p>–í–∞—à –∫–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π</p>
            <a href="/" class="btn btn-primary btn-sm" onclick="closeCartSidebar()">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –º–µ–Ω—é</a>
        </div>
    }
</div>

@if (Model != null && Model.Any())
{
    <div class="cart-sidebar-footer">
        <div class="cart-total">
            <span>–í—Å—å–æ–≥–æ:</span>
            <strong id="sidebar-cart-total">@total.ToString("0.00") ‚Ç¥</strong>
        </div>
        <a asp-controller="Order" asp-action="Checkout" class="btn btn-success w-100">
            –û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
        </a>
        <button type="button" class="btn btn-outline-secondary w-100 mt-2" onclick="closeCartSidebar()">
            üçï –û–±—Ä–∞—Ç–∏ —â–µ
        </button>
    </div>
}
